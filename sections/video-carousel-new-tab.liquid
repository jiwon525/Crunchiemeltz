

<div id="video-carousel-{{ section.id }}" class="video-carousel-section" style="background-color: {{ section.settings.section_bg_color }}; padding-top: {{ section.settings.section_padding_top }}px; padding-bottom: {{ section.settings.section_padding_bottom }}px;">
  <div class="video-carousel-container" style="width: {% if section.settings.full_width %}100%{% else %}80%{% endif %}; margin: 0 auto;">
    
    {% if section.settings.section_heading != blank %}
      <h2 class="section-heading">{{ section.settings.section_heading }}</h2>
    {% endif %}

    <div class="video-carousel-wrapper">
      {% if section.settings.show_arrows %}
        <button class="arrow left-arrow" data-target="video-carousel-{{ section.id }}">❮</button>
      {% endif %}

      <div class="video-carousel-slider" id="slider-{{ section.id }}">
        <div class="slider-track">
          {% for block in section.blocks %}
            {% if block.settings.video_url != blank %}
              <div class="slide" {% if section.settings.media_shadow %}style="box-shadow: 0 4px 8px rgba(0,0,0,0.2);" {% endif %}>
                <a href="/pages/video?url={{ block.settings.video_url | url_encode }}" target="_blank">
                  <video class="media-element" controls muted {% if section.settings.auto_play_videos %} autoplay loop {% endif %}>
                    <source src="{{ block.settings.video_url }}" type="video/mp4">
                  </video>
                </a>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>

      {% if section.settings.show_arrows %}
        <button class="arrow right-arrow" data-target="video-carousel-{{ section.id }}">❯</button>
      {% endif %}
    </div>
  </div>
</div>

<style>
.video-carousel-wrapper {
  display: flex;
  align-items: center;
  position: relative;
}

.video-carousel-slider {
  overflow: hidden;
  width: 100%;
}

.slider-track {
  display: flex;
  gap: 15px;
  transition: transform 0.3s ease;
}

.slide {
  flex: 0 0 auto;
  padding: 20px;
}

.media-element {
  max-width: 300px;
  height: auto;
  border-radius: 8px;
}



.arrow {
  background: {{ section.settings.arrow_bg_color | default: '#000' }}; /* customizable background */
  color: #fff; /* arrow color */
  border: none;
  font-size: 2.5rem; /* larger size */
  font-weight: bold; /* thicker */
  cursor: pointer;
  padding: 15px;
  border-radius: 50%; /* makes it round */
  transition: background 0.2s ease, transform 0.2s ease;
  z-index: 2;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 60px;

  position: absolute; /* ensure arrows are positioned relative to carousel */
  top: 50%;
  transform: translateY(-50%);
}

/* Move arrows away from video */
.left-arrow {
  left: -40px; /* adjust this value to increase space */
}

.right-arrow {
  right: -40px; /* adjust this value to increase space */
}

.arrow:hover {
  background: #333; /* darker on hover */
  transform: scale(1.1); /* slight zoom on hover */
}


.section-heading {
  text-align: center;
  margin-bottom: 20px;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const carousels = document.querySelectorAll("[id^='video-carousel-']");
  
  carousels.forEach(carousel => {
    const slider = carousel.querySelector(".video-carousel-slider");
    const track = slider.querySelector(".slider-track");
    const slides = track.querySelectorAll(".slide");
    const leftArrow = carousel.querySelector(".left-arrow");
    const rightArrow = carousel.querySelector(".right-arrow");

    const slideWidth = slides[0]?.offsetWidth + 15 || 300; // include gap
    let scrollAmount = 0;

    if (leftArrow) {
      leftArrow.addEventListener("click", () => {
        slider.scrollBy({ left: -slideWidth, behavior: "smooth" });
      });
    }

    if (rightArrow) {
      rightArrow.addEventListener("click", () => {
        slider.scrollBy({ left: slideWidth, behavior: "smooth" });
      });
    }
  });
});
</script>

{% schema %}
{
  "name": "Video Carousel (New Tab)",
  "settings": [
    {
      "type": "text",
      "id": "section_heading",
      "label": "Section Heading",
      "default": "Featured Videos"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "label": "Top Padding",
      "default": 40,
      "min": 0,
      "max": 200,
      "step": 5
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "label": "Bottom Padding",
      "default": 40,
      "min": 0,
      "max": 200,
      "step": 5
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_arrows",
      "label": "Show Arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "media_shadow",
      "label": "Enable Shadow on Videos",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "auto_play_videos",
      "label": "Autoplay Videos (Muted, Loop)",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL",
          
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Video Carousel (New Tab)",
      "category": "Custom"
    }
  ]
}
{% endschema %}
